# [Day 27] æ©Ÿå™¨å­¸ç¿’å¸¸çŠ¯éŒ¯çš„åä»¶äº‹
## ä»Šæ—¥å­¸ç¿’ç›®æ¨™
- æ¢è¨æ©Ÿå™¨å­¸ç¿’å¸¸çŠ¯çš„åå€‹éŒ¯èª¤

## å‰è¨€
äººå·¥æ™ºæ…§è¿‘å¹´ä¾†æˆç‚ºä»»ä½•ç”¢æ¥­ç†±é–€çš„è©±é¡Œä¹‹ä¸€ï¼Œå„å…¬å¸ç©æ¥µåœ°å°å…¥æ©Ÿå™¨å­¸ç¿’æŠ€è¡“å”åŠ©ç”¢æ¥­ AI åŒ–ã€‚ä¾‹å¦‚ï¼šæ™ºæ…§é†«ç™‚ã€æ™ºæ…§äº¤é€šã€æ™ºæ…§è£½é€ ......ç­‰ã€‚æ­£æ˜¯å› ç‚º AI æŠ€è¡“çš„å‰µæ–°èˆ‡æ™®åŠï¼Œè¨“ç·´æ©Ÿå™¨å­¸ç¿’æ¨¡å‹å†ä¹Ÿä¸æ˜¯ç†å·¥èƒŒæ™¯çš„äººæ‰èƒ½åšçš„äº‹ã€‚æ­¤å¤–éš¨è‘— Python é–‹ç™¼ç¤¾ç¾¤èŒå£¯ï¼Œè¨±å¤šé–‹æºçš„ AI å¥—ä»¶å¦‚é›¨å¾Œæ˜¥ç­èˆ¬çš„å‡ºç¾å¤§å¤§é™ä½äº†æ©Ÿå™¨å­¸ç¿’å»ºæ¨¡çš„é–€æª»ã€‚åœ¨ä»Šå¤©çš„å…§å®¹ä¸­æˆ‘æƒ³è—‰ç”±éµäººè³½ä¾†è·Ÿå¤§å®¶åˆ†äº«æ©Ÿå™¨å­¸ç¿’å¸¸çŠ¯éŒ¯çš„åä»¶äº‹ï¼Œä¸¦ä¸”å¾è³‡æ–™é¢èˆ‡æ¨¡å‹é¢çš„è§’åº¦ä¾†æ¢è¨æ©Ÿå™¨å­¸ç¿’æ‡‰è©²æ³¨æ„çš„å¹¾ä»¶äº‹ã€‚å°¤å…¶æ˜¯åœ¨åˆå­¸éšæ®µï¼Œå› ç¼ºä¹ç¶“é©—å¾€å¾€æœƒçŠ¯ä¸€äº›ç„¡å¯é¿å…çš„éŒ¯èª¤ã€‚æ‰€ä»¥é€™ç¯‡æ–‡ç« å°‡é»å‡ºåå€‹æ©Ÿå™¨å­¸ç¿’ä¸­å¸¸çŠ¯çš„éš±å½¢éŒ¯èª¤ã€‚

- è³‡æ–™é¢
  - è³‡æ–™æ”¶é›†èˆ‡è™•ç†ä¸ç•¶
  - è¨“ç·´é›†èˆ‡æ¸¬è©¦é›†çš„é¡åˆ¥åˆ†ä½ˆä¸ä¸€è‡´
  - æ²’æœ‰è³‡æ–™è¦–è¦ºåŒ–çš„ç¿’æ…£
  - ä½¿ç”¨ LabelEncoder ç‚ºç‰¹å¾µç·¨ç¢¼
  - è³‡æ–™è™•ç†ä¸ç•¶å°è‡´è³‡æ–™æ´©æ¼


- æ¨¡å‹é¢
  - åƒ…ä½¿ç”¨æ¸¬è©¦é›†è©•ä¼°æ¨¡å‹å¥½å£
  - åœ¨æ²’æœ‰äº¤å‰é©—è­‰çš„æƒ…æ³ä¸‹åˆ¤æ–·æ¨¡å‹æ€§èƒ½
  - åˆ†é¡å•é¡Œåƒ…ä½¿ç”¨æº–ç¢ºç‡ä½œç‚ºè¡¡é‡æ¨¡å‹çš„æŒ‡æ¨™
  - è¿´æ­¸å•é¡Œåƒ…ä½¿ç”¨ R2 åˆ†æ•¸è©•ä¼°æ¨¡å‹å¥½å£
  - ä»»ä½•äº‹æƒ…åˆ¥æ€¥è‘—æƒ³ç”¨ AI è§£æ±º

## 1. è³‡æ–™æ”¶é›†èˆ‡è™•ç†ä¸ç•¶
æ©Ÿå™¨å­¸ç¿’é¦–è¦çš„æ­¥é©Ÿæ˜¯å®šç¾©å•é¡Œï¼Œç•¶ç¢ºå®šç›®æ¨™èˆ‡æ–¹å‘å¾Œå³å¯é–‹å§‹æœé›†è³‡æ–™ã€‚ç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“ç¾å¯¦ç”Ÿæ´»ä¸­çš„è³‡æ–™å¾—ä¾†ä¸æ˜“ï¼Œå³ä½¿å¾è³‡æ–™åº«å–å¾—äº†é€™äº›è³‡æ–™å¾Œæˆ‘å€‘é‚„éœ€è¦èŠ±å¤§é‡çš„æ™‚é–“é€²è¡Œè³‡æ–™æ¸…æ´—ã€‚æ‰€è¬‚çš„è³‡æ–™æ¸…æ´—æ˜¯è³‡æ–™åº«ç•¶ä¸­å¯èƒ½æœƒæœ‰ç¼ºå¤±å€¼ï¼Œä¾‹å¦‚ï¼šNAã€Infã€NaNã€NULLã€‚

- NAï¼šè¡¨ç¤ºç¼ºå¤±å€¼ï¼Œæ˜¯ Not Available çš„ç¸®å¯«ã€‚
- Infï¼šè¡¨ç¤ºç„¡çª®å¤§ï¼Œæ˜¯ Infinite çš„ç¸®å¯«ã€‚
- NaNï¼šè¡¨ç¤ºéæ•¸å€¼ï¼Œæ˜¯ Not a Number çš„ç¸®å¯«ã€‚
- NULLï¼šè¡¨ç¤ºç©ºå€¼ï¼Œå³æ²’æœ‰å…§å®¹ã€‚

ç•¶è³‡æ–™éƒ½å®Œæˆäº†å‰è™•ç†å¾Œï¼Œå³å¯é–‹å§‹å»ºç«‹æ¨¡å‹èˆ‡è©•ä¼°æ¨¡å‹ã€‚ä½†æ˜¯ç•¶è¨“ç·´å‡ºä¾†çš„æ¨¡å‹è¡¨ç¾ä¸å¥½æœ‰å¾ˆå¤šçš„å› ç´ ã€‚å¤§å®¶æœ€å¸¸åšçš„æ˜¯æ›¿æ›æ¨¡å‹æ¼”ç®—æ³•ï¼Œæˆ–æ˜¯å˜—è©¦ä¸åŒçš„æ¨¡å‹è¶…åƒæ•¸å–å¾—ä¸€å€‹æœ€ä½³çš„çµæœã€‚ä½†æ˜¯åœ¨é€²è¡Œé€™äº›åšä¹‹å‰ï¼Œå»ºè­°å¤§å®¶å…ˆæŠŠé—œæ³¨çš„é»å›åˆ°è³‡æ–™è™•ç†é¢ã€‚æ¨¡å‹è¨“ç·´ä¸å¥½çš„å…¶ä¸­ä¸€å€‹å› ç´ æ˜¯è³‡æ–™çš„æ¨™ç±¤æ”¶é›†ä¸ç•¶ã€‚Landing.ai åŸ·è¡Œé•·å³æ©é”ä¹Ÿæ›¾ç¶“èªªéç•¶ä¸€å€‹å°è³‡æ–™é›†å­˜åœ¨è‘—éŒ¯èª¤æ¨™ç±¤æ™‚ï¼Œæ¨¡å‹å¾ˆé›£çµ¦å‡ºä¸€å€‹æ­£ç¢ºçš„è¼¸å‡ºã€‚å› ç‚ºè³‡æ–™é–“å¤¾å¸¶äº†é›œè¨Šå¾€å¾€æœƒä½¿çš„æ¨¡å‹å­˜åœ¨è‘—ä¸€äº›åå·®ï¼Œå°è‡´è¨“ç·´çµæœä¸ç©©å®šã€‚å› æ­¤ç­†è€…å»ºè­°æ¨¡å‹è¨“ç·´ä¸å¥½çš„æ™‚å€™ï¼Œå¯ä»¥å›é ­è§€å¯Ÿè³‡æ–™æ˜¯å¦å­˜åœ¨ä¸€äº›éŒ¯èª¤ã€‚è€Œä¸æ˜¯ä¸€æ˜§çš„èª¿æ•´æ¨¡å‹æ¼”ç®—æ³•èˆ‡è¶…åƒæ•¸ã€‚


## 2. è¨“ç·´é›†èˆ‡æ¸¬è©¦é›†çš„é¡åˆ¥åˆ†ä½ˆä¸ä¸€è‡´
åœ¨åˆ†é¡çš„è³‡æ–™ä¸­ï¼Œåˆå­¸è€…å¸¸è¦‹çš„éŒ¯èª¤æ˜¯å¿˜è¨˜ä½¿ç”¨åˆ†å±¤æŠ½æ¨£ (stratify) ä¾†å°è¨“ç·´é›†å’Œæ¸¬è©¦é›†é€²è¡Œåˆ‡å‰²ã€‚ç•¶æ¸¬è©¦é›†çš„åˆ†ä½ˆç›¡å¯èƒ½èˆ‡è¨“ç·´ç›¸åŒæƒ…æ³ä¸‹ï¼Œæ¨¡å‹æ‰æ›´æœ‰å¯èƒ½å¾—åˆ°æ›´æº–ç¢ºçš„é æ¸¬ã€‚ç„¶è€Œåœ¨åˆ†é¡çš„å•é¡Œä¸­ï¼Œæˆ‘å€‘å¿…é ˆæ›´é—œæ³¨æ¯å€‹é¡åˆ¥çš„è³‡æ–™åˆ†ä½ˆæ¯”ä¾‹ã€‚ä»¥ä¸‹èˆ‰å€‹ä¾‹å­ï¼šå‡è¨­æˆ‘å€‘æœ‰ä¸‰å€‹æ¨™ç±¤çš„é¡åˆ¥ï¼Œè€Œé€™ä¸‰å€‹é¡åˆ¥çš„åˆ†ä½ˆæ¯”ä¾‹åˆ†åˆ¥ç‚º 4:3:3ã€‚åŒç†æˆ‘å€‘åœ¨é€²è¡Œè³‡æ–™åˆ‡å‰²çš„æ™‚å€™å¿…é ˆç¢ºä¿è¨“ç·´é›†èˆ‡æ¸¬è©¦é›†éœ€è¦æœ‰ç›¸åŒçš„è³‡æ–™åˆ†ä½ˆæ¯”ä¾‹ã€‚

å¤§å®¶æ‡‰è©²éƒ½ä½¿ç”¨é Sklearn çš„ `train_test_split` é€²è¡Œè³‡æ–™åˆ‡å‰²ã€‚åœ¨æ­¤æ–¹æ³•ä¸­ Sklearn æä¾›äº†ä¸€å€‹ `stratify` åƒæ•¸é”åˆ°åˆ†å±¤éš¨æ©ŸæŠ½æ¨£çš„ç›®çš„ã€‚ç‰¹åˆ¥æ˜¯åœ¨åŸå§‹æ•¸æ“šä¸­æ¨£æœ¬æ¨™ç±¤åˆ†ä½ˆä¸å‡è¡¡æ™‚éå¸¸æœ‰ç”¨ï¼Œä¸€äº›åˆ†é¡å•é¡Œå¯èƒ½æœƒåœ¨ç›®æ¨™é¡çš„åˆ†ä½ˆä¸­è¡¨ç¾å‡ºå¾ˆå¤§çš„ä¸å¹³è¡¡ï¼šä¾‹å¦‚ï¼Œè² æ¨£æœ¬èˆ‡æ­£æ¨£æœ¬æ¯”ä¾‹æ‡¸æ®Š(ä¿¡ç”¨å¡ç›œåˆ·é æ¸¬ã€é›¢è·å“¡å·¥é æ¸¬)ã€‚ä»¥ä¸‹ç”¨ç´…é…’åˆ†é¡é æ¸¬ä¾†é€²è¡Œç¤ºç¯„ï¼Œé¦–å…ˆæˆ‘å€‘ä¸ä½¿ç”¨ `stratify` éš¨æ©Ÿåˆ‡å‰²è³‡æ–™ä¸¦æŸ¥çœ‹è³‡æ–™åˆ‡å‰²å‰å¾Œçš„ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹ã€‚

```py
import pandas as pd
from sklearn.datasets import load_wine
from sklearn.model_selection import train_test_split

X, y = load_wine(return_X_y=True)

# æŸ¥çœ‹å…¨éƒ¨è³‡æ–™ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
pd.Series(y).value_counts(normalize=True)
```

```
# å…¨éƒ¨è³‡æ–™ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
1    0.398876
0    0.331461
2    0.269663
dtype: float64
```

```py
# å¯¦é©—ä¸€: ä¸ä½¿ç”¨ stratify é€²è¡Œåˆ‡å‰²è³‡æ–™
X_train, X_test, y_train, y_test = train_test_split(X, y)


# æŸ¥çœ‹è¨“ç·´é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
pd.Series(y_train).value_counts(normalize=True)
# æŸ¥çœ‹æ¸¬è©¦é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
pd.Series(y_test).value_counts(normalize=True)
```

```
# è¨“ç·´é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
1    0.390977
0    0.330827
2    0.278195
dtype: float64

# æ¸¬è©¦é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
1    0.511111
0    0.266667
2    0.222222
dtype: float64
```

å¾ä¸Šé¢åˆ‡å‡ºä¾†çš„è¨“ç·´é›†èˆ‡æ¸¬è©¦é›†å¯ä»¥ç™¼ç¾ä¸‰å€‹é¡åˆ¥çš„è³‡æ–™åˆ†ä½ˆæ¯”ä¾‹éƒ½ä¸åŒã€‚å› æ­¤æˆ‘å€‘å¯ä»¥ä½¿ç”¨ `stratify` åƒæ•¸å†åˆ‡å‰²ä¸€æ¬¡ã€‚

```py
# å¯¦é©—äºŒ: ä½¿ç”¨ stratify é€²è¡Œåˆ‡å‰²è³‡æ–™
X_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y)

# æŸ¥çœ‹è¨“ç·´é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
pd.Series(y_train).value_counts(normalize=True)
# æŸ¥çœ‹æ¸¬è©¦é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
pd.Series(y_test).value_counts(normalize=True)
```

```
# è¨“ç·´é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
1    0.400000
0    0.333333
2    0.266667
dtype: float64

# æ¸¬è©¦é›†ä¸‰ç¨®é¡åˆ¥æ¯”ä¾‹
1    0.398496
0    0.330827
2    0.270677
dtype: float64
```

æˆ‘å€‘å¯ä»¥ç™¼ç¾å°‡ `stratify` è¨­ç½®ç‚ºç›®æ¨™ (y) åœ¨è¨“ç·´å’Œæ¸¬è©¦é›†ä¸­ç”¢ç”Ÿç›¸åŒçš„åˆ†ä½ˆã€‚å› ç‚ºæ”¹è®Šçš„é¡åˆ¥çš„æ¯”ä¾‹æ˜¯ä¸€å€‹åš´é‡çš„å•é¡Œï¼Œå¯èƒ½æœƒä½¿æ¨¡å‹æ›´åå‘æ–¼ç‰¹å®šçš„é¡åˆ¥ã€‚å› æ­¤è¨“ç·´è³‡æ–™çš„åˆ†ä½ˆå¿…é ˆè¦èˆ‡å¯¦éš›æƒ…æ³è¶Šæ¥è¿‘è¶Šå¥½ã€‚

## 3. æ²’æœ‰è³‡æ–™è¦–è¦ºåŒ–çš„ç¿’æ…£
è³‡æ–™è¦–è¦ºåŒ–çš„å¥½è™•å¤šå¤šï¼Œåœ¨æœ¬ç³»åˆ—æ–‡ç«  [[Day 3] ä½ çœŸäº†è§£è³‡æ–™å—ï¼Ÿè©¦è©¦çœ‹è¦–è¦ºåŒ–åˆ†æå§ï¼](https://ithelp.ithome.com.tw/articles/10264416) èˆ‡ [[Day 22] Python è¦–è¦ºåŒ–è§£é‡‹æ•¸æ“š - Plotly Express](https://ithelp.ithome.com.tw/articles/10277258) è¬›è§£äº†è¨±å¤š Python è³‡æ–™è¦–è¦ºåŒ–çš„æŠ€å·§ã€‚è³‡æ–™è¦–è¦ºåŒ–å¯ä»¥å¹«åŠ©æˆ‘å€‘åˆ†æèˆ‡çµ±è¨ˆè³‡æ–™çš„å‹æ…‹ï¼Œå¾€å¾€æœ‰å¥½çš„è³‡æ–™æ¸…æ´—èˆ‡å‰è™•ç†å°æ¨¡å‹é æ¸¬çµæœæœƒæœ‰å¤§å¹…çš„æå‡ã€‚æœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥åƒè€ƒ[å®‰æ–¯åº«å§†å››é‡ (Anscombeâ€™s quartet)](https://zh.wikipedia.org/wiki/%E5%AE%89%E6%96%AF%E5%BA%93%E5%A7%86%E5%9B%9B%E9%87%8D%E5%A5%8F)ã€‚ä»–ä¸»è¦æ˜¯æ˜¯é€éå››å€‹å°è³‡æ–™é›†ä¸¦é€éè¦–è¦ºåŒ–èˆ‡çµ±è¨ˆä¾†è§€å¯Ÿï¼Œä¸¦èªªæ˜åœ¨åˆ†ææ•¸æ“šå‰å…ˆç¹ªè£½åœ–è¡¨çš„é‡è¦æ€§ï¼Œä»¥åŠé›¢ç¾¤å€¼å°çµ±è¨ˆçš„å½±éŸ¿ä¹‹å¤§ã€‚

## 4. ä½¿ç”¨ LabelEncoder ç‚ºç‰¹å¾µç·¨ç¢¼
é€šå¸¸æˆ‘å€‘è¦ç‚ºé¡åˆ¥çš„ç‰¹å¾µé€²è¡Œç·¨ç¢¼ï¼Œç›´è¦ºæœƒæƒ³åˆ° Sklearn çš„ [LabelEncoder](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html)ã€‚ä½†æ˜¯å¦‚æœä¸€å€‹è³‡æ–™é›†ä¸­æœ‰å¤šå€‹ç‰¹å¾µæ˜¯å±¬æ–¼é¡åˆ¥å‹çš„è³‡æ–™ï¼Œè±ˆä¸æ˜¯å¾ˆéº»ç…©?å¿…é ˆè¦ä¸€å€‹ä¸€å€‹å‘¼å« LabelEncoder åˆ†åˆ¥ç‚ºé€™äº›ç‰¹å¾µé€²è¡Œè½‰æ›ã€‚å¦‚æœä½ çœ‹åˆ°é€™é‚Šæœ‰åŒæ„Ÿçš„ï¼Œåœ¨é€™è£¡è¦å‘Šè¨´ä½ äº‹å¯¦ä¸¦éå¦‚æ­¤ï¼æˆ‘å€‘çœ‹çœ‹ åœ¨å®˜æ–¹æ–‡ä»¶ä¸‹ LabelEncoder çš„æè¿°ï¼š

> This transformer should be used to encode target values, i.e. y, and not the input X.

ç°¡å–®ä¾†èªª LabelEncoder åªæ˜¯è¢«ç”¨ä¾†ç·¨ç¢¼è¼¸å‡ºé … y è€Œå·²çš„ï¼ä½ é‚„åœ¨ç”¨å®ƒä¾†ç·¨ç¢¼ä½ çš„æ¯å€‹ x å—ï¼Ÿï¼ˆæšˆ

é‚£éº¼æˆ‘å€‘è©²ç”¨ä»€éº¼æ–¹æ³•ä¾†ç·¨ç¢¼æœ‰é †åºçš„é¡åˆ¥ç‰¹å¾µå‘¢ï¼Ÿå¦‚æœä½ ä»”ç´°é–±è®€æœ‰é—œç·¨ç¢¼åˆ†é¡ç‰¹å¾µçš„ Sklearn ç”¨æˆ¶æŒ‡å—ï¼Œä½ æœƒçœ‹åˆ°å®ƒæ¸…æ¥šåœ°èªªæ˜ï¼š

> To convert categorical features to integer codes, we can use the OrdinalEncoder. This estimator transforms each categorical feature to one new feature of integers (0 to n_categories - 1)

çœ‹åˆ°é€™é‚Šå¤§å®¶æ‡‰è©²çŸ¥é“é–±è®€å®˜æ–¹æ–‡ä»¶çš„é‡è¦æ€§å§ï¼å®˜æ–¹æ–‡ä»¶ä¸­å»ºè­° x é …çš„è¼¸å…¥ç‰¹å¾µå¯ä»¥æ¡ç”¨ [OrdinalEncoder](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OrdinalEncoder.html) ä¸€æ¬¡ç‚ºæ‰€æœ‰ç‰¹å¾µä¾åºåš Label Encodingã€‚OrdinalEncoder ç·¨ç¢¼å™¨çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

```py
from sklearn.preprocessing import OrdinalEncoder
enc = OrdinalEncoder()
X = [['Male', 1], ['Female', 3], ['Female', 2]]
enc.fit(X)

print(enc.categories_)
enc.transform([['Female', 3], ['Male', 1]])
```

```
[array(['Female', 'Male'], dtype=object), array([1, 2, 3], dtype=object)]
array([[0., 2.],
       [1., 0.]])
```

ä»¥ä¸Šçš„ç¯„ä¾‹æ˜¯ X æœ‰ä¸‰ç­†è³‡æ–™ï¼Œæ¯ç­†è³‡æ–™éƒ½æœ‰å…©å€‹ç‰¹å¾µã€‚æˆ‘å€‘å¯ä»¥ç™¼ç¾ç¬¬ä¸€å€‹ç‰¹å¾µæ˜¯æ€§åˆ¥ Male èˆ‡ Femaleï¼Œå› æ­¤ OrdinalEncoder æœƒä¾é€ å­—æ¯é–‹é ­åšæ’åº Female ç·¨ç¢¼ç‚º 0 è€Œ Male ç·¨ç¢¼ç‚º 1ã€‚å¦å¤–ç¬¬äºŒå€‹ç‰¹å¾µç‚ºæ•¸å­— 1ã€2ã€3ï¼ŒåŒç†ä¾åºç‚ºä»–å€‘ç·¨ç¢¼æˆ 0ã€1ã€2ã€‚åªéœ€é–±è®€å®˜æ–¹æ–‡æª”å’Œç”¨æˆ¶æŒ‡å—ï¼Œä½ å°±å¯ä»¥äº†è§£å¾ˆå¤šé—œæ–¼ Sklearn çš„çŸ¥è­˜ï¼æ˜¯ä¸æ˜¯å¾ˆæ£’ï½

## 5. è³‡æ–™è™•ç†ä¸ç•¶å°è‡´è³‡æ–™æ´©æ¼
è³‡æ–™æ´©æ¼ (data leakage) æ˜¯å€‹éš±å½¢æ®ºæ‰‹ï¼Œå®ƒæœƒåœ¨ä¸çŸ¥ä¸è¦ºä¸­å½±éŸ¿æ¨¡å‹é æ¸¬çµæœã€‚å…¶ç™¼ç”Ÿçš„æ™‚æ©Ÿåœ¨æ–¼ä½ åœ¨è¨“ç·´éç¨‹ä¸­ï¼Œä¸æ‡‰è©²å°‡æ¸¬è©¦çš„è³‡æ–™çš„è³‡è¨Šæ´©æ¼åˆ°è¨“ç·´éç¨‹ä¸­ã€‚å®ƒæœƒé€ æˆæ¨¡å‹çµ¦å‡ºä¸€å€‹éå¸¸æ¨‚è§€çš„çµæœï¼Œå³ä½¿åœ¨äº¤å‰é©—è­‰ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä½†åœ¨å°å¯¦éš›æ–°æ•¸æ“šé€²è¡Œæ¸¬è©¦æ™‚è¡¨ç¾æœƒéå¸¸åœ°ç³Ÿç³•ã€‚

è³‡æ–™æ´©æ¼æœ€å¸¸ç™¼ç”Ÿæ–¼è³‡æ–™å‰è™•ç†çš„éšæ®µï¼Œå°¤å…¶æ˜¯ç•¶ä½ çš„è¨“ç·´é›†å’Œæ¸¬è©¦é›†å°šæœªåˆ‡å‰²çš„æ™‚å€™ã€‚Sklearn æä¾›äº†è¨±å¤šè³‡æ–™å‰è™•ç†çš„æ–¹æ³•ï¼Œä¾‹å¦‚: ç¼ºå¤±å€¼è£œå€¼(imputers)ã€æ­£è¦åŒ– (normalizers)ã€æ¨™æº–åŒ–(standardization)ä»¥åŠå°æ•¸(log) è½‰æ›...ç­‰ã€‚é€™äº›è½‰æ›å™¨éƒ½æœƒä¾è³´æ–¼ä½ è¼¸å…¥è³‡æ–™çš„åˆ†ä½ˆï¼Œä¸¦ä¾ç…§æ­¤åˆ†ä½ˆåšç›¸å°æ‡‰çš„æ“¬åˆã€‚

èˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘å€‘åœ¨åšæ¨™æº–åŒ–æ™‚(StandardScaler)é€éå¾æ¯ç­†è³‡æ–™ä¸­æ¸›å»å¹³å‡å€¼ä¸¦å°‡å…¶é™¤ä»¥æ¨™æº–åå·®ä¾†ç²å¾—ç¸®æ”¾å¾Œçš„æ•¸æ“šã€‚æˆ‘å€‘ä½¿ç”¨ `fit()` æ–¹æ³•åœ¨æ‰€æœ‰è³‡æ–™é›† X ä¸Šåšè½‰æ›ï¼Œä¸¦ä½¿å¾—è½‰æ›å™¨å­¸ç¿’æ¯å€‹ç‰¹å¾µçš„æ•´å€‹åˆ†ä½ˆçš„å¹³å‡å€¼å’Œæ¨™æº–å·®ã€‚é€™äº›è³‡æ–™è½‰æ›å¾Œå¦‚æœå†å°‡é€™äº›æ•¸æ“šæ‹†åˆ†ç‚ºè¨“ç·´é›†å’Œæ¸¬è©¦é›†ï¼Œå‰‡è¨“ç·´é›†æœƒå—åˆ°æ±¡æŸ“ã€‚å› ç‚º StandardScaler å¾å¯¦éš›åˆ†ä½ˆä¸­æ´©éœ²äº†æ¸¬è©¦é›†é‡è¦è¨Šæ¯ï¼Œä¸€èˆ¬ä¾†èªªæˆ‘å€‘ä¸èƒ½å°‡æ¸¬è©¦é›†çš„åˆ†ä½ˆæƒ…æ³èˆ‡è¨“ç·´é›†æ··åœ¨ä¸€èµ·ã€‚é›–ç„¶æˆ‘å€‘å¸Œæœ›è¨“ç·´é›†çš„åˆ†ä½ˆèˆ‡å¯¦éš›æ¸¬è©¦é›†çš„åˆ†ä½ˆè¦è¶Šæ¥è¿‘è¶Šå¥½ï¼Œå› ç‚ºä½¿å¾—æ¨¡å‹è¡¨ç¾çµæœç©©å®šã€‚

é›–ç„¶æˆ‘å€‘æŠŠæ¸¬è©¦é›†èˆ‡è¨“ç·´é›†æ··åœ¨ä¸€èµ·ä¸¦åšè½‰æ›ï¼Œé€™ä¸€æ­¥é©Ÿå°æˆ‘å€‘ä¾†èªªå¯èƒ½æ²’ä»€éº¼ã€‚ä½†æ˜¯å°æ–¼ Sklearn å¼·å¤§çš„æ¼”ç®—æ³•ï¼Œå¯èƒ½æœƒé€éé€™å€‹éºæ¼æ¸¬è©¦é›†çš„åˆ†ä½ˆçš„è¨Šæ¯æŠŠæ¨¡å‹æ“¬åˆçš„å¾ˆå¥½ã€‚å±†æ™‚æ¨¡å‹è¨“ç·´å®Œæˆå¾Œï¼Œæ¸¬è©¦é›†ä¸å¤ æ–°ç©ï¼Œç„¡æ³•åœ¨å¯¦éš›çœ‹ä¸è¦‹çš„æ•¸æ“šä¸Šæ¸¬è©¦æ¨¡å‹çš„æ€§èƒ½ã€‚

æœ€ç°¡å–®çš„è§£æ±ºè¾¦æ³•ï¼Œå°±æ˜¯ä¸è¦ä½¿ç”¨ `fit()` ä¸€æ¬¡è½‰æ›æ‰€æœ‰çš„è³‡æ–™ã€‚åœ¨åšä»»ä½•è³‡æ–™è½‰æ›ä¹‹å‰è¦å…ˆç¢ºä¿è¨“ç·´é›†èˆ‡æ¸¬è©¦é›†å·²ç¶“å®Œæ•´åœ°è¢«åˆ‡é–‹ã€‚å³ä½¿åˆ‡é–‹å¾Œä¹Ÿä¸è¦å†æ‹¿æ¸¬è©¦é›†å‘¼å« `fit()` æˆ– `fit_transform()`ï¼Œé€™ä¸€æ¨£æœƒå°è‡´ç›¸åŒå•é¡Œç™¼ç”Ÿã€‚å› ç‚ºè¨“ç·´é›†å’Œæ¸¬è©¦é›†å¿…é ˆé€²è¡Œç›¸åŒçš„è½‰æ›ï¼Œä¾ç…§å®˜æ–¹çš„ç¯„ä¾‹æˆ‘å€‘å¿…é ˆå…ˆä½¿ç”¨ `fit_transform()` åœ¨è¨“ç·´é›†ä¸Šé€²è¡Œæ“¬åˆèˆ‡è½‰æ›ã€‚é€™ç¢ºä¿äº†è½‰æ›å™¨åƒ…å¾è¨“ç·´é›†å­¸ç¿’ï¼Œå¾ä¸­æ‰¾å‡ºåƒæ•¸ä¾‹å¦‚å¹³å‡å€¼èˆ‡è®Šç•°æ•¸ä¸¦åŒæ™‚å°å…¶é€²è¡Œè®Šæ›ã€‚æ¥è‘—ä½¿ç”¨ `transform()` æ–¹æ³•åœ¨æ¸¬è©¦è³‡æ–™ä¸Šé€²è¡Œè½‰æ›ï¼Œæ ¹æ“šå¾è¨“ç·´æ•¸æ“šä¸­å­¸åˆ°çš„è¨Šæ¯é€²è¡Œè½‰æ›ã€‚

```py
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

X, y = load_iris(return_X_y=True)
X_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y, random_state=44)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)
```

æ›´å¼·å¤§çš„è§£æ±ºæ–¹æ¡ˆæ˜¯ä½¿ç”¨ Sklearn å…§å»ºçš„ pipelineï¼Œå®ƒèƒ½å¤ ä¿è­·æ¨¡å‹å…æ–¼è³‡æ–™æ´©æ¼çš„å•é¡Œã€‚æ­¤æ–¹æ³•èƒ½å¤ ç¢ºä¿è¨“ç·´è³‡æ–™åƒ…åƒèˆ‡è½‰æ›æ“¬åˆèˆ‡æ¨¡å‹è¨“ç·´ï¼Œè€Œæ¸¬è©¦è³‡æ–™åƒ…ç”¨æ–¼è¨ˆç®—ä¸¦é©—è­‰æ¨¡å‹ã€‚


## 6. åƒ…ä½¿ç”¨æ¸¬è©¦é›†è©•ä¼°æ¨¡å‹å¥½å£
å¦‚æœä½ çš„æ¸¬è©¦è³‡æ–™ R2 score å¾—åˆ°äº† 0.85 å°±ä»£è¡¨å¾ˆå¥½äº†å—ï¼Ÿä¸ç›¡ç„¶ï¼å„˜ç®¡æœ‰é«˜çš„æ¸¬è©¦åˆ†æ•¸é€šå¸¸æ„å‘³è‘—æ¨¡å‹è¡¨ç¾ä½³ï¼Œä½†åœ¨è§£é‡‹æ¸¬è©¦çµæœæ™‚ä»æœ‰ä¸€äº›é‡è¦çš„æ³¨æ„äº‹é …ã€‚é¦–å…ˆæœ€é‡è¦çš„ï¼Œç„¡è«–åˆ†æ•¸å€¼å¦‚ä½•æ¸¬è©¦é›†çš„åˆ†æ•¸ä¸€å®šè¦èˆ‡è¨“ç·´é›†ç›¸æ¯”è¼ƒæ‰èƒ½ç¢ºä¿æ¨¡å‹è¨“ç·´å¥½èˆ‡å£ã€‚ç•¶ä½ çš„æ¨¡å‹è¨“ç·´é›†åˆ†æ•¸é«˜æ–¼æ¸¬è©¦é›†çš„åˆ†æ•¸ï¼Œä¸¦ä¸”å…©è€…éƒ½è¶³å¤ é«˜ä»¥æ»¿è¶³å°ˆæ¡ˆçš„ç›®æ¨™æœŸæœ›æ™‚é€™ä»£è¡¨ä½ è¨“ç·´äº†ä¸€å€‹å¥½æ¨¡å‹ã€‚ç„¶è€Œé€™ä¸¦ä¸æ„å‘³è‘—è¨“ç·´å’Œæ¸¬è©¦åˆ†æ•¸ä¹‹é–“çš„å·®ç•°è¶Šå¤§è¶Šå¥½ã€‚èˆ‰å€‹ä¾‹å­ï¼Œè‹¥è¨“ç·´é›†çš„ R2 score ç‚º 0.85 æ¸¬è©¦é›†ç‚º 0.8 å³ä»£è¡¨æ¨¡å‹æ—¢ä¸éåº¦æ“¬åˆ(overfit)ä¹Ÿä¸æ¬ æ“¬åˆ(underfit)ã€‚ä½†æ˜¯å¦‚æœè¨“ç·´é›† 0.9 æ¸¬è©¦é›† 0.7 çš„æ™‚å€™ï¼Œä½ çš„æ¨¡å‹å°±æ˜¯éæ“¬åˆã€‚å…¶åŸå› æ˜¯è©²æ¨¡å‹æ²’æœ‰åœ¨è¨“ç·´æœŸé–“é€²è¡Œæ³›åŒ–ï¼Œè€Œæ˜¯è¨˜ä½äº†ä¸€äº›è¨“ç·´æ•¸æ“šï¼Œå¾è€Œå°è‡´æ¸¬è©¦åˆ†æ•¸ä½å¾—å¤šã€‚

åœ¨åˆ¤æ–·è¨“ç·´é›†èˆ‡æ¸¬è©¦é›† ğ‘…2 åˆ†æ•¸å·®ç•°æ™‚ï¼Œé›–ç„¶æ²’æœ‰å›ºå®šçš„æ¯”ä¾‹ï¼Œä½†æœ‰ä¸€äº›ç¶“é©—æ³•å‰‡å¯ä»¥å¹«åŠ©ä½ æ›´å¥½åœ°è©•ä¼°æ¨¡å‹æ˜¯å¦éæ“¬åˆï¼š

- **5%~10%** å·®ç•°ï¼šå¯æ¥å—ï¼Œè¡¨ç¤ºæ¨¡å‹å¯èƒ½æ³›åŒ–è‰¯å¥½ã€‚
- **10%~20%** å·®ç•°ï¼šéœ€æ³¨æ„ï¼Œå¯èƒ½éæ“¬åˆã€‚
- **>20%** å·®ç•°ï¼šåš´é‡éæ“¬åˆï¼Œæ¨¡å‹éœ€è¦é€²ä¸€æ­¥èª¿æ•´ã€‚

**èˆ‰ä¾‹ï¼š**

- å¦‚æœä½ çš„è¨“ç·´é›† ğ‘… 2 = 0.9ï¼Œè€Œæ¸¬è©¦é›† ğ‘… 2 = 0.88 ï¼Œé€™æ„å‘³è‘—æ¨¡å‹çš„å·®ç•°åªæœ‰ 2%ï¼Œæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›é€šå¸¸æ˜¯å¥½çš„ã€‚
- ä½†æ˜¯å¦‚æœè¨“ç·´é›† ğ‘… 2 = 0.95ï¼Œæ¸¬è©¦é›† ğ‘… 2 = 0.6ï¼Œé‚£éº¼å·®ç•°ç‚º 35%ï¼Œé€™å°±è¡¨æ˜æ¨¡å‹å¾ˆå¯èƒ½éæ“¬åˆã€‚

!!! note

    **éœ€è¦æ³¨æ„çš„å¹¾é»ï¼š**
    
    1. è¡Œæ¥­å’Œæ•¸æ“šé¡å‹å·®ç•°ï¼šä¸åŒæ‡‰ç”¨é ˜åŸŸå’Œæ•¸æ“šé›†çš„ç‰¹æ€§å¯èƒ½æœƒå° ğ‘…2 åˆ†æ•¸æœŸæœ›æœ‰æ‰€ä¸åŒï¼Œæœ‰äº›æ‡‰ç”¨å³ä½¿æœ‰ 10-15% çš„å·®ç•°ä¹Ÿèƒ½è¢«æ¥å—ï¼Œè€Œæœ‰äº›æ‡‰ç”¨ï¼ˆå¦‚é†«ç™‚ã€é‡‘èï¼‰å‰‡è¦æ±‚æ›´é«˜çš„æº–ç¢ºæ€§ã€‚

    2. å¤šæ¬¡è©•ä¼°ï¼šå»ºè­°ä½¿ç”¨äº¤å‰é©—è­‰ä¾†ç²å–æ›´å¤šç©©å®šçš„è©•ä¼°æŒ‡æ¨™ï¼Œè€Œä¸åƒ…åƒ…ä¾è³´ä¸€æ¬¡çš„è¨“ç·´/æ¸¬è©¦é›†çµæœã€‚


åœ¨å¤§å¤šæ•¸ä»»å‹™ä¸­ä½ å°‡æœƒçœ‹åˆ°è¨±å¤šäººä½¿ç”¨ tree-based æ¨¡å‹æˆ–æ˜¯æ•´é«”å­¸ç¿’æ¨¡å‹ (ensemble models)ã€‚ä¾‹å¦‚åœ¨éš¨æ©Ÿæ£®æ—æ¼”ç®—æ³•ç•¶ä¸­å¦‚æœå®ƒå€‘çš„æ¨¹æ·±åº¦å¤ªæ·±ï¼Œå¾€å¾€æœƒç²å¾—éå¸¸é«˜çš„è¨“ç·´åˆ†æ•¸ï¼Œå¾è€Œå°è‡´éåº¦æ“¬åˆã€‚å¦å¤–ä¹Ÿæœ‰æ¸¬è©¦é›†çš„åˆ†æ•¸æ¯”è¨“ç·´é›†é«˜çš„æƒ…æ³ï¼Œè‹¥ç™¼ç”Ÿæ­¤æƒ…æ³æ™‚é€šå¸¸éƒ½æœƒæ„Ÿè¦ºæ˜¯ä¸æ˜¯åšéŒ¯äº†ä»€éº¼ã€‚é€™ç¨®æƒ…æ³çš„ä¸»è¦åŸå› æ˜¯è³‡æ–™æ´©æ¼ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ç¯€æˆ‘å€‘è¨è«–çš„æƒ…æ³ã€‚æˆ–æ˜¯ä½ çš„æ¸¬è©¦è³‡æ–™ç­†æ•¸å¤ªå°‘ï¼Œæ²’è¾¦æ³•è¶³ä»¥é©—è­‰æ¨¡å‹å¥½å£ã€‚

å¦å¤–æœ‰æ™‚å€™æˆ‘å€‘ä¹Ÿæœƒå¾—åˆ°åœ¨è¨“ç·´é›†æœ‰å¾ˆå¥½çš„è¡¨ç¾ä½†æ¸¬è©¦é›†ç„¡æ•µå·®çš„æƒ…æ³ã€‚ç•¶è¨“ç·´å’Œæ¸¬è©¦åˆ†æ•¸å·®ç•°å¾ˆå¤§æ™‚ï¼Œå•é¡Œå¾€å¾€èˆ‡æ¸¬è©¦é›†æœ‰é—œè€Œä¸æ˜¯éåº¦æ“¬åˆã€‚é€™æ™‚å€™ä½ å¯èƒ½è¦æª¢æŸ¥è³‡æ–™é è™•ç†çš„æ–¹å¼æ˜¯å¦ä¸€è‡´ (åƒæ˜¯å– log æˆ– scale)ï¼Œæˆ–æ˜¯åªæ˜¯å¿˜è¨˜å°æ¸¬è©¦é›†åšè½‰æ›è™•ç†ã€‚

é€™è£¡åšä¸€å€‹å°çµï¼Œç¸½ä¹‹åœ¨è¨“ç·´å¥½æ¨¡å‹æ™‚è«‹ä»”ç´°æª¢æŸ¥è¨“ç·´å’Œæ¸¬è©¦åˆ†æ•¸ä¹‹é–“çš„å·®è·ã€‚ä¸¦ä¸”å¯ä»¥é€éæ­¤è©•ä¼°æ–¹å¼æª¢è¦–æ¨¡å‹æ˜¯å¦éæ“¬åˆï¼ŒåŒæ™‚ä¹Ÿèƒ½é€²è¡Œæ¨¡å‹æ¢åƒæˆ–æ˜¯é¸æ“‡æœ€ä½³çš„è³‡æ–™é è™•ç†æ–¹å¼ã€‚ä¸¦ç‚ºæœ€çµ‚çš„æ¨¡å‹åšæœ€ä½³çš„æº–å‚™ã€‚

## 7. åœ¨æ²’æœ‰äº¤å‰é©—è­‰çš„æƒ…æ³ä¸‹åˆ¤æ–·æ¨¡å‹æ€§èƒ½
æˆ‘æƒ³å¤§å®¶æ‡‰è©²éƒ½ç†Ÿç·´æŒæ¡äº† overfitting é€™å€‹è­°é¡Œã€‚é€™æ˜¯æ©Ÿå™¨å­¸ç¿’ä¸­ä¸€å€‹è¿«åˆ‡å•é¡Œï¼Œä¸¦å·²ç¶“è¨­è¨ˆäº†ç„¡æ•¸å€‹æ–¹æ³•ä¾†è§£æ±ºå®ƒã€‚æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯å°‡ä¸€éƒ¨åˆ†æ•¸æ“šä½œç‚ºæ¸¬è©¦é›†ä¾†æ¨¡æ“¬å’Œæ¸¬é‡æ¨¡å‹åœ¨çœ‹ä¸è¦‹çš„æ•¸æ“šä¸Šçš„æ€§èƒ½ã€‚ä½†æ˜¯æˆ‘å€‘å¯ä»¥èª¿æ•´æ¨¡å‹çš„è¶…åƒæ•¸ï¼Œç›´åˆ°æ¨¡å‹åœ¨è©²ç‰¹å®šæ¸¬è©¦é›†ä¸Šé”åˆ°æœ€é«˜åˆ†æ•¸ï¼Œé€™åˆæ„å‘³è‘—æŸç¨®å«ç¾©çš„éåº¦æ“¬åˆã€‚å› æ­¤æˆ‘å€‘å¯ä»¥æœƒå°‡å®Œæ•´æ•¸æ“šçš„å¦ä¸€éƒ¨åˆ†ä½œç‚º`é©—è­‰é›†`å†æ¬¡è§£æ±ºé€™å€‹å•é¡Œã€‚æ¨¡å‹å°‡åœ¨è¨“ç·´æ•¸æ“šä¸Šé€²è¡Œè¨“ç·´ï¼Œä¸¦åœ¨é©—è­‰é›†ä¸Šå¾®èª¿å…¶åƒæ•¸ï¼Œä¸¦åœ¨æ¸¬è©¦é›†ä¸Šé€²è¡Œæœ€çµ‚è©•ä¼°ã€‚

![](./image/img27-1.png)

ä½†æ˜¯å°‡æˆ‘å€‘å¯¶è²´çš„æ•¸æ“šåˆ†æˆä¸‰çµ„æ„å‘³è‘—æ¨¡å‹å¯ä»¥å­¸ç¿’çš„æ•¸æ“šé‡æ›´å°‘ã€‚æ­¤å¤–æ¨¡å‹çš„æ•´é«”é æ¸¬æ€§èƒ½å°‡å–æ±ºæ–¼é‚£å°ç‰¹å®šçš„è¨“ç·´é›†å’Œé©—è­‰é›†ã€‚å› æ­¤åœ¨é€²è¡Œæ©Ÿå™¨å­¸ç¿’æ™‚æœ€å¸¸ä½¿ç”¨ K-Fold cross-validation è§£æ±ºä¸Šè¿°å•é¡Œã€‚è©³ç´°å…§å®¹å¯ä»¥åƒè€ƒæˆ‘çš„å‰å…©å¤©æ–‡ç« [[Day 25] äº¤å‰é©—è­‰ Cross-Validation ç°¡ä»‹](https://ithelp.ithome.com.tw/articles/10278851)ä»¥åŠ[[Day 26] äº¤å‰é©—è­‰ K-Fold Cross-Validation](https://ithelp.ithome.com.tw/articles/10279240)ã€‚æ ¹æ“šæˆ‘å€‘è¨­å®šçš„ K å€¼ï¼Œå¯ä»¥å®Œæ•´çš„å°‡æ•¸æ“šè¢«åˆ†æˆ K çµ„ foldsï¼Œå°æ–¼æ¯å€‹ folds æ¯æ¬¡æ¨¡å‹è¨“ç·´æœƒæŠŠ K-1 çµ„ä½œç‚ºè¨“ç·´é›†ï¼Œè€Œå‰©ä¸‹çš„è¢«æ­¸é¡ç‚ºé©—è­‰é›†ã€‚ç•¶æ¨¡å‹äº¤å‰é©—è­‰çµæŸå¾Œï¼Œè¨“ç·´é›†æ‰€æœ‰è³‡æ–™æœƒè¢«å®Œæ•´çš„è¨“ç·´ã€‚

![](./image/img27-2.png)

## 8. åˆ†é¡å•é¡Œåƒ…ä½¿ç”¨æº–ç¢ºç‡ä½œç‚ºè¡¡é‡æ¨¡å‹çš„æŒ‡æ¨™
åœ¨é è¨­çš„æƒ…æ³ä¸‹æ‰€æœ‰ Sklearn åˆ†é¡å™¨åœ¨å‘¼å« `score()` å‡½æ•¸æ™‚éƒ½ä½¿ç”¨æº–ç¢ºåº¦ä½œç‚ºè©•åˆ†æ–¹æ³•ã€‚ç”±æ–¼æº–ç¢ºç‡çš„è¨ˆç®—æ–¹å¼ç°¡å–®èˆ‡å®¹æ˜“ç†è§£ï¼Œå› æ­¤ç¶“å¸¸æœƒçœ‹åˆ°åˆå­¸è€…å»£æ³›ä½¿ç”¨å®ƒä¾†åˆ¤æ–·å…¶æ¨¡å‹çš„æ€§èƒ½ã€‚ä¸å¹¸çš„æ˜¯é€™ç¨®ä¸€èˆ¬æº–ç¢ºç‡çš„è©•ä¼°æ–¹å¼åªå°é¡åˆ¥å¹³è¡¡çš„äºŒå…ƒåˆ†é¡å•é¡Œæœ‰ç”¨ã€‚

ç„¶è€Œåœ¨å…¶ä»–çš„ç‹€æ³ä¸‹å®ƒæ˜¯ä¸€å€‹èª¤å°æ€§çš„æŒ‡æ¨™ï¼Œå³ä½¿æ˜¯è¡¨ç¾æœ€å·®çš„æ¨¡å‹ä¹Ÿå¯èƒ½èƒŒå¾Œéš±è—è‘—é«˜æº–ç¢ºåº¦çš„åˆ†æ•¸ã€‚èˆ‰ä¾‹ä¾†èªªæœ‰å€‹åµæ¸¬åƒåœ¾éƒµä»¶çš„æ¨¡å‹å®ƒçš„æº–ç¢ºç‡ 90%ï¼Œä½†æ˜¯å¯¦éš›ä¸Šå®ƒæ ¹æœ¬ç„¡æ³•åµæ¸¬åˆ°åƒåœ¾éƒµä»¶ã€‚é€™æ˜¯ç‚ºä»€éº¼ï¼Ÿç”±æ–¼åƒåœ¾éƒµä»¶ä¸¦ä¸å¸¸è¦‹ï¼Œåˆ†é¡å™¨å¯ä»¥æª¢æ¸¬æ‰€æœ‰éåƒåœ¾éƒµä»¶ï¼Œå³ä½¿åˆ†é¡å™¨å®Œå…¨ç„¡æ³•é”åˆ°å…¶ç›®çš„é€™ä¹Ÿå¯ä»¥æé«˜å…¶æº–ç¢ºæ€§ã€‚å› ç‚ºé€™å€‹åˆ†é¡å™¨åƒ…å¯ä»¥åˆ†é¡é€™äº›æ­£å¸¸éƒµä»¶ï¼Œç¨€å°‘çš„åƒåœ¾éƒµä»¶æ ¹æœ¬è®Šèªä¸å‡ºä¾†ã€‚

å°æ–¼å¤šå…ƒé¡åˆ†é¡çš„å•é¡Œæ›´æ˜¯æ‡‰è©²æ³¨æ„ä½ çš„æ¨¡å‹è©•ä¼°æŒ‡æ¨™ã€‚å¦‚æœé”åˆ° 80% çš„æº–ç¢ºç‡ï¼Œæ˜¯å¦æ„å‘³è‘—æ¨¡å‹åœ¨é æ¸¬é¡åˆ¥1ã€é¡åˆ¥2ã€é¡åˆ¥3ç”šè‡³æ‰€æœ‰é¡æ™‚ä¸€æ¨£æº–ç¢ºå‘¢ï¼Ÿä¸€èˆ¬çš„æº–ç¢ºç‡æ°¸é ç„¡æ³•å›ç­”æ­¤é¡å•é¡Œï¼Œä½†å¹¸é‹çš„æ˜¯å…¶ä»–åˆ†é¡æŒ‡æ¨™æä¾›äº†æ›´å¤šçš„è¨Šæ¯æŒ‡æ¨™ã€‚å®ƒå°±æ˜¯[æ··æ·†çŸ©é™£](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html)(confusion matrix)ã€‚

```py
from sklearn.metrics import confusion_matrix
y_true = [2, 0, 2, 2, 0, 1]
y_pred = [0, 0, 2, 2, 0, 2]
confusion_matrix(y_true, y_pred)
```

```
array([[2, 0, 0],
       [0, 0, 1],
       [1, 0, 2]])
```


çµ„æˆæ··æ·†çŸ©é™£çš„å››å€‹å…ƒç´ åˆ†åˆ¥æœ‰ TPã€TNã€FPã€FNã€‚åŸºæœ¬ä¸Šæ··æ·†çŸ©é™£æœƒæ‹¿é€™å››å€‹æŒ‡æ¨™åšåƒè€ƒï¼ŒåŒæ™‚ç®—å‡ºä¾†çš„åˆ†æ•¸ä¹Ÿæ›´èƒ½å»è©•ä¼°ä½ çš„æ¨¡å‹è¨“ç·´çš„çµæœã€‚æ­¤å¤–æˆ‘å€‘å¯ä»¥åˆ©ç”¨æ··æ·†çŸ©é™£ä¾†è¨ˆç®— Precisionã€Recallã€Accuracy ç­‰åˆ†æ•¸ã€‚

- TP(True Positive): æ­£ç¢ºé æ¸¬æˆåŠŸçš„æ­£æ¨£æœ¬ï¼Œä¾‹å¦‚çœŸå¯¦ç­”æ¡ˆ(Ground True)æ˜¯è²“ï¼ŒæˆåŠŸçš„æŠŠä¸€å¼µè²“çš„ç…§ç‰‡é æ¸¬æˆè²“ï¼Œå³ç‚ºTP
- TN(True Negative): æ­£ç¢ºé æ¸¬æˆåŠŸçš„è² æ¨£æœ¬ï¼ŒæˆåŠŸçš„æŠŠä¸€å¼µç‹—çš„ç…§ç‰‡æ¨™ç¤ºæˆä¸æ˜¯è²“ï¼Œå³ç‚ºTN
- FP(False Positive): éŒ¯èª¤é æ¸¬æˆæ­£æ¨£æœ¬ï¼Œå¯¦éš›ä¸Šç‚ºè² æ¨£æœ¬ï¼Œä¾‹å¦‚ï¼šéŒ¯èª¤çš„æŠŠä¸€å¼µç‹—çš„ç…§ç‰‡é æ¸¬æˆè²“
- FN(False Negative): éŒ¯èª¤é æ¸¬æˆè² æ¨£æœ¬ï¼Œå¯¦éš›ä¸Šç‚ºæ­£æ¨£æœ¬ï¼Œä¾‹å¦‚ï¼šéŒ¯èª¤çš„æŠŠä¸€å¼µè²“çš„ç…§ç‰‡é æ¸¬æˆä¸æ˜¯è²“

## 9. è¿´æ­¸å•é¡Œåƒ…ä½¿ç”¨ R2 åˆ†æ•¸è©•ä¼°æ¨¡å‹å¥½å£
åœ¨é æ¸¬é€£çºŒæ€§æ•¸å€¼è¼¸å‡ºçš„è¿´æ­¸æ¨¡å‹ä¸­ï¼Œå¤§å®¶å¾€å¾€æœƒç›´æ¥å‘¼å«æ¨¡å‹æä¾›çš„è©•ä¼°æ–¹æ³•ç›´æ¥è¨ˆç®— `score`ã€‚ç„¶è€Œé€™å€‹åˆ†æ•¸åœ¨è¿´æ­¸æ¨¡å‹ä¸­æ˜¯è¨ˆç®— R2 åˆ†æ•¸ï¼Œåˆç¨±åˆ¤å®šä¿‚æ•¸ (coefficient of determination)ã€‚æ‰€è¬‚çš„åˆ¤å®šä¿‚æ•¸æ˜¯è¼¸å…¥ç‰¹å¾µ (x) å»è§£é‡‹è¼¸å‡º (y) çš„è®Šç•°ç¨‹åº¦æœ‰å¤šå°‘ï¼Œå…¶è¨ˆç®—å…¬å¼æ˜¯ï¼šè¿´æ­¸æ¨¡å‹çš„è®Šç•°é‡ (SSR)/ç¸½è®Šç•°é‡ (TSS) ã€‚ç”¨ä»¥ä¸‹è®Šç•°æ•¸åˆ†æè¡¨ï¼ˆANOVA tableï¼‰ä¾†èªª TSS å°±æ˜¯è¨ˆç®—ç¸½è®Šç•°ï¼ŒæŠŠæ¯å€‹å¯¦éš›çš„ y æ¸›å»å¹³å‡æ•¸çš„å¹³æ–¹åŠ ç¸½èµ·ä¾†ã€‚è€Œ SSR å°±æ˜¯æŠŠæ‰€æœ‰çš„æ¨¡å‹é æ¸¬ y æ¸›å»å¹³å‡æ•¸çš„å¹³æ–¹åŠ ç¸½èµ·ä¾†ã€‚å¦‚æœ R2 åˆ†æ•¸å¾ˆé«˜è¶Šæ¥è¿‘ 1ï¼Œè¡¨ç¤ºæ¨¡å‹çš„è§£é‡‹èƒ½åŠ›å¾ˆé«˜ã€‚

![](./image/img27-3.png)

åœ¨å­¸è¡“ç ”ç©¶ä¸Šæœ€ç›´è¦ºçš„è§€å¿µæ˜¯ R2 åˆ†æ•¸æ„ˆæ¥è¿‘ 1 è¶Šå¥½ï¼Œä¹Ÿæœ‰äº›äººé€éä¸€äº›æ‰‹æ®µä¾†è£½é€  R2 åˆ†æ•¸å¾ˆé«˜çš„å‡è±¡ï¼Œè©³ç´°å…§å®¹å¯ä»¥åƒè€ƒé€™ç¯‡[æ–‡ç« ](http://amebse.nchu.edu.tw/new_page_535.htm)ã€‚å…¶å¯¦åªé€é R2 å€‹è©•ä¼°æŒ‡æ¨™å°±ä¾†æ±ºå®šä¸€å€‹æ¨¡å‹çš„å¥½å£æ˜¯ä¸å¤ªå¥½çš„ç¿’æ…£ã€‚æ›´é€²ä¸€æ­¥å¯ä»¥ä½¿ç”¨ MSEã€MAE ç­‰æ®˜å·®çš„è©•ä¼°å€¼æ¨™ä¾†çœ‹æ¯ç­†è³‡æ–™å¯¦éš›å€¼èˆ‡é æ¸¬å€¼çš„èª¤å·®ã€‚æˆ–æ˜¯ä½¿ç”¨ç›¸å°èª¤å·®ä¾†è§€å¯Ÿé æ¸¬æ¨¡å‹çš„å¯ä¿¡åº¦ã€‚æ­¤å¤–ç­†è€…é‚„å»ºè­°å¯ä»¥è©¦è‘—æŠŠæ¯ç­†è³‡æ–™çš„çœŸå¯¦ y èˆ‡æ¨¡å‹é æ¸¬çš„ Å· ç¹ªè£½å‡ºä¾†ï¼Œè‹¥å‘ˆç¾ä¸€æ¢æ˜é¡¯çš„ç”±å·¦ä¸‹åˆ°å³ä¸Šæ–œç›´ç·šï¼Œå‰‡è¡¨ç¤ºæ¨¡å‹æ‰€é æ¸¬çš„çµæœèˆ‡çœŸå¯¦ç­”æ¡ˆå¾ˆç›¸è¿‘ã€‚

![](./image/img27-4.png)


## 10. ä»»ä½•äº‹æƒ…åˆ¥æ€¥è‘—æƒ³ç”¨ AI è§£æ±º
è¿‘å¹¾å¹´ AI çš„ç™¼å±•æƒ³å¿…å¤§å®¶æœ‰ç›®å…±ç¹ï¼Œå¾å½±åƒè­˜åˆ¥åˆ°ç‰©ä»¶è¾¨è­˜çš„æŠ€è¡“æœ‰è‘—é‡å¤§çš„é€²å±•ã€‚æ­¤å¤– 2016 å¹´ Google Deepmind åœ˜éšŠçš„ AlphaGo é¦–åº¦æ‰“æ•—äººé¡ï¼Œé€™ä¹Ÿåœ¨äººæ©Ÿå°å¼ˆä¸Šé–‹å•Ÿäº†ä¸€é …é‡è¦çš„é‡Œç¨‹ç¢‘ã€‚ç”šè‡³åœ¨è‡ªç„¶èªè¨€æ–¹é¢ï¼Œæ­¸åŠŸæ–¼æ–°çš„æ¨¡å‹æ¶æ§‹èˆ‡ç¡¬é«”è³‡æºçš„é€²æ­¥ï¼Œä½¿å¾—è‡ªç„¶èªè¨€æœ‰é‡å¤§çš„çªç ´ã€‚çœ‹åˆ°é€™éº¼å¤š AI çš„ç¾å¥½è®“å¤§å®¶å†æ¬¡å°æ·±åº¦å­¸ç¿’é»ç‡ƒå¸Œæœ›ï¼åªä¸é AI ä¸¦éè¬èƒ½ï¼Œåˆ‡è¨˜ï¼æ‰€æœ‰çš„å•é¡Œä¸¦ä¸æ˜¯å°‡è³‡æ–™æ”¶é›†å¥½ï¼Œä¸¦å°‡è³‡æ–™ä¸Ÿçµ¦é›»è…¦å­¸ç¿’å°±æœƒå¾—åˆ°ä½ æƒ³è¦çš„çµæœã€‚å¤§å®¶ä¹Ÿè¨±æœƒé™·å…¥ã€Œç‚º AI è€Œ AIã€ çš„è¿·æ€ï¼Œå¾ˆå¤šçš„ä»»å‹™å…¶å¯¦é€éå…·æœ‰è¦å‰‡çš„å°ˆå®¶ç³»çµ±æˆ–æ˜¯å‚³çµ±æ¼”ç®—æ³•å°±å¯ä»¥é”åˆ°å¾ˆä¸éŒ¯çš„çµæœã€‚å†è€…æˆ‘å€‘éƒ½å° AI çš„æŠ€è¡“æ„Ÿåˆ°ç‰¹åˆ¥æ­¡å–œèˆ‡æœŸå¾…ï¼Œä½†æ˜¯ AI çš„é»‘ç›’å­äººé¡å¾€å¾€ä¸çŸ¥é“æ¨¡å‹ä¸‹ä¸€æ­¥æœƒç”¢ç”Ÿä»€éº¼ä¸å¯é æœŸçš„çµæœã€‚å…¶å¯¦ AI æœ‰å¾ˆå¤šçš„é™åˆ¶èˆ‡æŒ‘æˆ°ï¼Œé™¤äº†å»ºç«‹æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ä»¥å¤–ï¼Œæˆ‘å€‘æ›´éœ€è¦é—œæ³¨çš„æ˜¯æ¨¡å‹åœ¨æƒ³ä»€éº¼ã€‚å¯è§£é‡‹äººå·¥æ™ºæ…§å¿…ç„¶æ˜¯æˆ‘å€‘è¦æ¢è¨çš„ä¸€æ®µèª²é¡Œã€‚AI èˆ‡æ©Ÿå™¨äººçš„å‡ºç¾ä¸¦ä¸æ˜¯è¦å–ä»£äººé¡ï¼Œæˆ‘èªç‚º AI æ¯”è¼ƒé©åˆæ‰®æ¼”è¼”åŠ©äººé¡çš„é‡è¦è§’è‰²ã€‚

> æœ¬ç³»åˆ—æ•™å­¸å…§å®¹åŠç¯„ä¾‹ç¨‹å¼éƒ½å¯ä»¥å¾æˆ‘çš„ [GitHub](https://github.com/andy6804tw/2021-13th-ironman) å–å¾—ï¼
